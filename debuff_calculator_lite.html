<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ‡ãƒãƒ•è¨ˆç®—ãƒ„ãƒ¼ãƒ«</title>
    <!-- Tailwind CSS CDNã‚’èª­ã¿è¾¼ã¿ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Interãƒ•ã‚©ãƒ³ãƒˆã‚’é©ç”¨ */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7ffec; /* æŸ”ã‚‰ã‹ãªèƒŒæ™¯è‰² */
        }
        .card {
            box-shadow: 0 10px 25px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
    </style>
</head>
<body class="p-4 sm:p-8 min-h-screen flex items-center justify-center">

    <div id="app" class="w-full max-w-xl bg-white p-6 sm:p-8 rounded-xl card border border-gray-200">
        <h1 class="text-3xl font-bold text-center text-gray-800 mb-6 border-b pb-2">
            ãƒ‡ãƒãƒ•è¨ˆç®—ãƒ„ãƒ¼ãƒ«
        </h1>

        <!-- å…¥åŠ›ã‚¨ãƒªã‚¢ -->
        <div class="space-y-6">
            <!-- å‘³æ–¹å´ã®å…¥åŠ› -->
            <div class="bg-indigo-50 p-4 rounded-lg border border-indigo-200">
                <h2 class="text-xl font-semibold text-indigo-700 mb-4">
                    <span class="mr-2">ğŸ›¡ï¸</span>å‘³æ–¹æƒ…å ±
                </h2>
                <!-- æˆ¦åŠ›å…¥åŠ› -->
                <div class="mb-4">
                    <label for="myPower" class="block text-sm font-medium text-gray-700">
                        è‡ªåˆ†ã®æˆ¦åŠ› (ä¸‡å˜ä½)
                    </label>
                    <input type="number" id="myPower" min="1"
                           class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-3 border focus:border-indigo-500 focus:ring-indigo-500 transition">
                </div>
                <!-- å±æ€§é¸æŠã‚¨ãƒªã‚¢ã¯å‰Šé™¤ã—ã¾ã—ãŸ -->
            </div>

            <!-- æ•µå´ã®å…¥åŠ› -->
            <div class="bg-red-50 p-4 rounded-lg border border-red-200">
                <h2 class="text-xl font-semibold text-red-700 mb-4">
                    <span class="mr-2">âš”ï¸</span>æ•µæƒ…å ±
                </h2>
                <!-- æˆ¦åŠ›å…¥åŠ› -->
                <div class="mb-4">
                    <label for="enemyPower" class="block text-sm font-medium text-gray-700">
                        ç›¸æ‰‹ã®æˆ¦åŠ› (ä¸‡å˜ä½)
                    </label>
                    <input type="number" id="enemyPower" min="1"
                           class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-3 border focus:border-red-500 focus:ring-red-500 transition">
                </div>
                <!-- å±æ€§é¸æŠã‚¨ãƒªã‚¢ã¯å‰Šé™¤ã—ã¾ã—ãŸ -->
            </div>
        </div>

        <!-- è¨ˆç®—ãƒœã‚¿ãƒ³ -->
        <button id="calculateButton" onclick="calculateDebuff()"
                class="w-full mt-8 py-3 bg-green-600 hover:bg-green-700 text-white font-bold text-lg rounded-xl shadow-lg transform transition hover:scale-[1.01] active:scale-[0.99] focus:outline-none focus:ring-4 focus:ring-green-300">
            è¨ˆç®—ã™ã‚‹
        </button>

        <!-- çµæœè¡¨ç¤ºã‚¨ãƒªã‚¢ -->
        <div id="results" class="mt-8 pt-6 border-t border-gray-300 space-y-4">
            <h2 class="text-2xl font-bold text-gray-800 text-center">
                è¨ˆç®—çµæœ
            </h2>
            
            <!-- å±æ€§è£œæ­£ãƒ†ã‚­ã‚¹ãƒˆã¯å‰Šé™¤ã—ã¾ã—ãŸ -->
            
            <div id="output" class="text-center p-4 rounded-lg bg-green-100 border border-green-300">
                
                <p class="text-lg text-gray-700 font-semibold mb-2">å¿…è¦ãªç­ã®æ•° (6äºº/ç­)</p>
                <p id="neededSquads" class="text-4xl font-extrabold text-green-800">- ç­</p>
                
                <p class="text-lg text-gray-700 font-semibold mb-2 mt-4">å¿…è¦ãªè¿½åŠ äººæ•°</p>
                <p id="neededPeople" class="text-3xl font-extrabold text-green-700">- äºº</p>
            </div>
            
            <!-- ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤ºã‚¨ãƒªã‚¢ -->
            <div id="errorMessage" class="hidden p-3 bg-yellow-100 border border-yellow-400 text-yellow-800 rounded-md text-center font-medium">
                <!-- ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒã“ã“ã«å…¥ã‚‹ -->
            </div>
        </div>
        
        <!-- ãƒ•ãƒƒã‚¿ãƒ¼æƒ…å ± -->
        <div class="mt-6 pt-4 border-t border-gray-200 text-center text-xs text-gray-500 space-y-1">
            <p>X: nek0n0tem0</p>
            <p>â€»ã“ã®ã‚¢ãƒ—ãƒªã§ã¯ãƒ‡ãƒ¼ã‚¿ä¿å­˜æ©Ÿèƒ½ã¯ä½¿ç”¨ã—ã¦ã„ã¾ã›ã‚“</p>
        </div>
    </div>

    <script>
        // ç­ã®è¨ˆç®—ã«ä½¿ç”¨ã™ã‚‹å›ºå®šä¿‚æ•° (å…ƒã®ã‚¢ãƒ—ãƒªã‹ã‚‰æµç”¨)
        const SQUAD_SCALING_FACTOR = 80;

        // åˆæœŸãƒ­ãƒ¼ãƒ‰æ™‚ã®è¨­å®š
        document.addEventListener('DOMContentLoaded', () => {
            // åˆå›ãƒ­ãƒ¼ãƒ‰æ™‚ã«ä¸€åº¦è¨ˆç®—ã‚’å®Ÿè¡Œ
            calculateDebuff();
            
            // å…¥åŠ›æ¬„ã®å€¤ãŒå¤‰æ›´ã•ã‚ŒãŸã‚‰å†è¨ˆç®—ã™ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¨­å®š
            document.getElementById('myPower').addEventListener('input', calculateDebuff);
            document.getElementById('enemyPower').addEventListener('input', calculateDebuff);
        });


        /**
         * å±æ€§è£œæ­£ã‚’ç„¡è¦–ã—ã€æˆ¦åŠ›ã®å·®ã«åŸºã¥ã„ã¦å¿…è¦ãªç­ã®æ•°ã¨äººæ•°ã‚’è¨ˆç®—ã™ã‚‹ãƒ¡ã‚¤ãƒ³é–¢æ•°
         */
        function calculateDebuff() {
            const myPowerInput = document.getElementById('myPower');
            const enemyPowerInput = document.getElementById('enemyPower');
            const errorMessageDiv = document.getElementById('errorMessage');
            const outputDiv = document.getElementById('output');
            
            errorMessageDiv.classList.add('hidden');
            outputDiv.classList.remove('bg-blue-100', 'border-blue-300');
            outputDiv.classList.add('bg-green-100', 'border-green-300');

            // 1. å…¥åŠ›å€¤ã®å–å¾—ã¨ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
            const myPower = parseFloat(myPowerInput.value);
            const enemyPower = parseFloat(enemyPowerInput.value);

            if (isNaN(myPower) || myPower <= 0 || isNaN(enemyPower) || enemyPower <= 0) {
                // åˆæœŸå€¤ãŒç©ºæ¬„ï¼ˆNaNã«ãªã‚‹ï¼‰ã®å ´åˆã€ã“ã®ã‚¨ãƒ©ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã¾ã™
                errorMessageDiv.textContent = 'æˆ¦åŠ›ã«ã¯1ä»¥ä¸Šã®æ­£ã®æ•°ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚';
                errorMessageDiv.classList.remove('hidden');
                document.getElementById('neededSquads').textContent = '- ç­';
                document.getElementById('neededPeople').textContent = '- äºº';
                return;
            }

            // 2. å±æ€§è£œæ­£ã‚’ç„¡è¦–ã—ã€ä¹—æ•° M = 1.00 ã¨ã™ã‚‹
            const multiplier = 1.00;
            
            // 3. æœ‰åŠ¹æˆ¦åŠ› (å±æ€§è£œæ­£ãªã—) ã¨ä¸è¶³ç‡ã®è¨ˆç®—
            const effectiveMyPower = myPower * multiplier;
            
            // æ•µæˆ¦åŠ›ã«å¯¾ã™ã‚‹æˆ¦åŠ›ã®ä¸è¶³ç‡ã‚’è¨ˆç®—: (1 - P_my / P_enemy)
            const deficitRatio = 1 - (effectiveMyPower / enemyPower);

            let neededSquads = 0;
            let neededPeople = 0;
            
            // 4. ä¸è¶³ç‡ãŒ0ã‚ˆã‚Šå¤§ãã„å ´åˆã€ç­ã®è¨ˆç®—ã‚’å®Ÿè¡Œ
            if (deficitRatio > 0) {
                // ä¸è¶³ç‡ã«å®šæ•°80ã‚’ä¹—ã˜ã‚‹: (1 - Ratio) * 80
                const squadCalculationBase = deficitRatio * SQUAD_SCALING_FACTOR;
                
                // åˆ‡ã‚Šä¸Šã’: ROUNDUP(...)
                const roundedSquads = Math.ceil(squadCalculationBase);
                
                // max(0, ...)
                neededSquads = Math.max(0, roundedSquads);
                
                // 5. äººæ•°ã‚’è¨ˆç®— (1ç­ = 6äºº)
                neededPeople = neededSquads * 6;
            }

            // 6. çµæœã®è¡¨ç¤º
            document.getElementById('neededSquads').textContent = `${neededSquads} ç­`;
            document.getElementById('neededPeople').textContent = `${neededPeople} äºº`;
            
            // å¿…è¦ãªç­æ•°ãŒ0ã®å ´åˆã®ç‰¹åˆ¥è¡¨ç¤º
            if (neededSquads === 0) {
                document.getElementById('neededSquads').textContent = 'ä¸è¦';
                document.getElementById('neededPeople').textContent = 'ä¸è¦';
                outputDiv.classList.remove('bg-green-100', 'border-green-300');
                outputDiv.classList.add('bg-blue-100', 'border-blue-300'); // é’ç³»ã®è‰²ã«å¤‰æ›´
            } else {
                outputDiv.classList.remove('bg-blue-100', 'border-blue-300');
                outputDiv.classList.add('bg-green-100', 'border-green-300'); // ç·‘ç³»ã®è‰²ã«å¤‰æ›´
            }
        }
    </script>
</body>
</html>
