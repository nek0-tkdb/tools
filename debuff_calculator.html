<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ‡ãƒãƒ•è¨ˆç®—ãƒ„ãƒ¼ãƒ« v3.0</title>
    <!-- Tailwind CSS CDNã‚’èª­ã¿è¾¼ã¿ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Interãƒ•ã‚©ãƒ³ãƒˆã‚’é©ç”¨ */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7ffec; /* æŸ”ã‚‰ã‹ãªèƒŒæ™¯è‰² */
        }
        .card {
            box-shadow: 0 10px 25px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        /* é¸æŠçŠ¶æ…‹ã‚’æ˜ç¢ºã«ã™ã‚‹ãŸã‚ã®ã‚«ã‚¹ã‚¿ãƒ ã‚¹ã‚¿ã‚¤ãƒ« */
        .attribute-button {
            transition: all 0.2s;
            background-color: #e5e7eb; /* gray-200 */
            color: #4b5563; /* gray-600 */
            border: 1px solid #d1d5db; /* gray-300 */
        }
        .attribute-button.selected {
            font-weight: 700;
            color: white !important;
            border-width: 2px;
            box-shadow: 0 0 0 2px rgba(34, 197, 94, 0.5); 
            transform: translateY(-2px);
        }
        /* å±æ€§ãƒœã‚¿ãƒ³ã‚’å°ã•ãã—ã¦6ã¤ä¸¦ã¹ã‚„ã™ãã™ã‚‹ */
        .attribute-button-compact {
            padding: 0.5rem 0.25rem; /* ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã‚’å°ã•ã */
            font-size: 0.75rem; /* æ–‡å­—ã‚’å°ã•ã */
        }
        .text-2xs {
            font-size: 0.65rem; 
            line-height: 1rem;
        }
        /* ã‚¹ãƒ­ãƒƒãƒˆã‚’éš ã™ãŸã‚ã®åŸºæœ¬ã‚¹ã‚¿ã‚¤ãƒ« */
        .slot-container {
            transition: max-height 0.3s ease-out, opacity 0.3s ease-out;
            max-height: 1000px; /* åˆæœŸè¡¨ç¤ºç”¨ */
            opacity: 1;
            overflow: hidden;
        }
        .slot-container.hidden {
            max-height: 0;
            opacity: 0;
            margin-bottom: 0 !important;
        }
    </style>
</head>
<body class="p-4 sm:p-8 min-h-screen flex items-center justify-center">

    <div id="app" class="w-full max-w-xl bg-white p-6 sm:p-8 rounded-xl card border border-gray-200">
        <h1 class="text-3xl font-bold text-center text-gray-800 mb-6 border-b pb-2">
            ãƒ‡ãƒãƒ•è¨ˆç®—ãƒ„ãƒ¼ãƒ« v3.0 (æœ€å¤§6ä¸»åŠ›)
        </h1>

        <!-- å…¥åŠ›ã‚¨ãƒªã‚¢ -->
        <div class="space-y-6">
            
            <!-- å‘³æ–¹å´ã®å…¥åŠ›ã‚³ãƒ³ãƒ†ãƒŠ -->
            <div class="bg-indigo-50 p-4 rounded-lg border border-indigo-200">
                <h2 class="text-xl font-semibold text-indigo-700 mb-4">
                    <span class="mr-2">ğŸ›¡ï¸</span>å‘³æ–¹æƒ…å ± (è‡ªåˆ†)
                </h2>
                
                <div class="space-y-4 pr-2">
                    <!-- ä¸»åŠ›1ã‹ã‚‰6ã¾ã§ã®å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’å‹•çš„ã«ç”Ÿæˆ -->
                    <script>
                        const localNumSlots = 6;
                        document.write('<div id="myInputs">');
                        for(let i = 1; i <= localNumSlots; i++) {
                            const hiddenClass = i > 1 ? 'hidden' : ''; // ä¸»åŠ›2ä»¥é™ã¯åˆæœŸéè¡¨ç¤º
                            document.write(`
                                <div id="mySlot${i}" class="slot-container p-3 bg-indigo-100 rounded-md border border-indigo-200 mb-4 last:mb-0 ${hiddenClass}">
                                    <h3 class="font-bold text-indigo-600 mb-2">ä¸»åŠ›${i} (vs æ•µä¸»åŠ›${i})</h3>
                                    <!-- æˆ¦åŠ›å…¥åŠ› -->
                                    <div class="mb-3">
                                        <label for="myPower${i}" class="block text-sm font-medium text-gray-700">æˆ¦åŠ› (ä¸‡å˜ä½)</label>
                                        <input type="number" id="myPower${i}" min="1"
                                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-3 border focus:border-indigo-500 focus:ring-indigo-500 transition" oninput="calculateDebuff()">
                                    </div>
                                    <!-- å±æ€§é¸æŠ -->
                                    <div>
                                        <span class="block text-sm font-medium text-gray-700 mb-2">å±æ€§</span>
                                        <div id="myAttribute${i}" class="flex justify-between space-x-1">
                                            <button type="button" data-attribute="fire" data-bg="bg-red-500" data-border="border-red-600" class="attribute-button attribute-button-compact flex-1 py-2 rounded-lg font-semibold" onclick="selectAttribute('my', ${i}, 'fire')">ğŸ”¥ ç«</button>
                                            <button type="button" data-attribute="water" data-bg="bg-blue-500" data-border="border-blue-600" class="attribute-button attribute-button-compact flex-1 py-2 rounded-lg font-semibold" onclick="selectAttribute('my', ${i}, 'water')">ğŸ’§ æ°´</button>
                                            <button type="button" data-attribute="grass" data-bg="bg-green-500" data-border="border-green-600" class="attribute-button attribute-button-compact flex-1 py-2 rounded-lg font-semibold" onclick="selectAttribute('my', ${i}, 'grass')">ğŸŒ¿ è‰</button>
                                        </div>
                                    </div>
                                </div>
                            `);
                        }
                        document.write('</div>');
                    </script>
                </div>
            </div>

            <!-- æ•µå´ã®å…¥åŠ›ã‚³ãƒ³ãƒ†ãƒŠ -->
            <div class="bg-red-50 p-4 rounded-lg border border-red-200">
                <h2 class="text-xl font-semibold text-red-700 mb-4">
                    <span class="mr-2">âš”ï¸</span>æ•µæƒ…å ± (ç›¸æ‰‹)
                </h2>

                <div class="space-y-4 pr-2">
                    <!-- ä¸»åŠ›1ã‹ã‚‰6ã¾ã§ã®å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’å‹•çš„ã«ç”Ÿæˆ -->
                    <script>
                        const localNumSlotsEnemy = 6;
                        document.write('<div id="enemyInputs">');
                        for(let i = 1; i <= localNumSlotsEnemy; i++) {
                            const hiddenClass = i > 1 ? 'hidden' : ''; // ä¸»åŠ›2ä»¥é™ã¯åˆæœŸéè¡¨ç¤º
                            document.write(`
                                <div id="enemySlot${i}" class="slot-container p-3 bg-red-100 rounded-md border border-red-200 mb-4 last:mb-0 ${hiddenClass}">
                                    <h3 class="font-bold text-red-600 mb-2">ä¸»åŠ›${i} (vs å‘³æ–¹ä¸»åŠ›${i})Â </h3>
                                    <!-- æˆ¦åŠ›å…¥åŠ› -->
                                    <div class="mb-3">
                                        <label for="enemyPower${i}" class="block text-sm font-medium text-gray-700">æˆ¦åŠ› (ä¸‡å˜ä½)</label>
                                        <input type="number" id="enemyPower${i}" min="1"
                                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-3 border focus:border-red-500 focus:ring-red-500 transition" oninput="calculateDebuff()">
                                    </div>
                                    <!-- å±æ€§é¸æŠ -->
                                    <div>
                                        <span class="block text-sm font-medium text-gray-700 mb-2">å±æ€§</span>
                                        <div id="enemyAttribute${i}" class="flex justify-between space-x-1">
                                            <button type="button" data-attribute="fire" data-bg="bg-red-500" data-border="border-red-600" class="attribute-button attribute-button-compact flex-1 py-2 rounded-lg font-semibold" onclick="selectAttribute('enemy', ${i}, 'fire')">ğŸ”¥ ç«</button>
                                            <button type="button" data-attribute="water" data-bg="bg-blue-500" data-border="border-blue-600" class="attribute-button attribute-button-compact flex-1 py-2 rounded-lg font-semibold" onclick="selectAttribute('enemy', ${i}, 'water')">ğŸ’§ æ°´</button>
                                            <button type="button" data-attribute="grass" data-bg="bg-green-500" data-border="border-green-600" class="attribute-button attribute-button-compact flex-1 py-2 rounded-lg font-semibold" onclick="selectAttribute('enemy', ${i}, 'grass')">ğŸŒ¿ è‰</button>
                                        </div>
                                    </div>
                                </div>
                            `);
                        }
                        document.write('</div>');
                    </script>
                </div>
            </div>
        </div>

        <!-- ä¸»åŠ›è¿½åŠ ãƒœã‚¿ãƒ³ -->
        <button id="addSlotButton" onclick="addSlot()"
                class="w-full mt-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-xl shadow-md transform transition hover:scale-[1.005] active:scale-[0.99] focus:outline-none focus:ring-4 focus:ring-indigo-300">
            ä¸»åŠ›è¿½åŠ  (ç¾åœ¨ 1 / 6)
        </button>
        
        <!-- çµæœè¡¨ç¤ºã‚¨ãƒªã‚¢ -->
        <div id="results" class="mt-8 pt-6 border-t border-gray-300 space-y-4">
            <h2 class="text-2xl font-bold text-gray-800 text-center">
                è¨ˆç®—çµæœ
            Â  Â  </h2>

            <!-- å±æ€§è£œæ­£è©³ç´°ï¼ˆå…¥åŠ›ã•ã‚ŒãŸã‚‚ã®ã ã‘å‹•çš„ã«è¡¨ç¤ºï¼‰ -->
            <div id="multiplierText" class="text-center text-gray-600 font-medium p-3 bg-gray-50 rounded-lg border border-gray-200 max-h-40 overflow-y-auto">
                <p class="text-sm text-gray-500">ä¸»åŠ›ã”ã¨ã®å±æ€§è£œæ­£ç‡ãŒã“ã“ã«å…¥ã‚Šã¾ã™ (å…¥åŠ›ãŒã‚ã£ãŸçµ„ã®ã¿)</p>
            </div>
            
            <!-- åˆè¨ˆæˆ¦åŠ›ã‚µãƒãƒªãƒ¼ -->
            <div id="summaryPower" class="text-center p-3 rounded-lg bg-yellow-50 border border-yellow-200 text-gray-700 font-semibold shadow-sm">
                <p class="text-lg">å‘³æ–¹æœ‰åŠ¹åˆè¨ˆæˆ¦åŠ›: <span id="effectiveTotalPower" class="text-yellow-800 font-extrabold">0</span> ä¸‡</p>
                <p class="text-lg">æ•µåˆè¨ˆæˆ¦åŠ›: <span id="enemyTotalPower" class="text-red-600 font-extrabold">0</span> ä¸‡</p>
            </div>

            <!-- å¿…è¦ãªç­æ•°ã¨äººæ•° -->
            <div id="output" class="text-center p-4 rounded-lg bg-gray-100 border border-gray-300 shadow-md">
                
                <p class="text-lg text-gray-700 font-semibold mb-2">å¿…è¦ãªç­ã®æ•° (6äºº/ç­)</p>
                <p id="neededSquads" class="text-4xl font-extrabold text-gray-600">å…¥åŠ›å¾…ã¡</p>
                
                <p class="text-lg text-gray-700 font-semibold mb-2 mt-4">å¿…è¦ãªè¿½åŠ äººæ•°</p>
                <p id="neededPeople" class="text-3xl font-extrabold text-gray-500">å…¥åŠ›å¾…ã¡</p>
            </div>
            
            <!-- ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤ºã‚¨ãƒªã‚¢ -->
            <div id="errorMessage" class="hidden p-3 bg-yellow-100 border border-yellow-400 text-yellow-800 rounded-md text-center font-medium">
                <!-- ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒã“ã“ã«å…¥ã‚‹ -->
            </div>
        </div>

        <!-- ãƒ•ãƒƒã‚¿ãƒ¼ã‚¨ãƒªã‚¢ - ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚’ç¸®å° -->
        <div class="mt-8 pt-4 border-t border-gray-200 text-center">
            <p class="text-xs text-gray-500 mb-1">
                **è£½ä½œè€…æƒ…å ±:** X: nek0n0tem0
            </p>
            <p class="text-2xs text-red-500 font-medium">
                â€» ã“ã®ã‚¢ãƒ—ãƒªã§ã¯å…¥åŠ›ã—ãŸãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜æ©Ÿèƒ½ã¯ä½¿ç”¨ã—ã¦ã„ã¾ã›ã‚“ã€‚
            </p>
        </div>
    </div>

    <script>
        // æœ€å¤§å…¥åŠ›ã‚¹ãƒ­ãƒƒãƒˆæ•°
        const NUM_SLOTS = 6; 
        // ç¾åœ¨è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã‚¹ãƒ­ãƒƒãƒˆæ•°
        let currentSlotCount = 1; 

        // å±æ€§é–“ã®ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼ˆæˆ¦åŠ›ï¼‰ä¹—æ•°ãƒ†ãƒ¼ãƒ–ãƒ«
        const multipliers = {
            'fire': { 'fire': 1.00, 'water': 0.80, 'grass': 1.25 },
            'water': { 'fire': 1.25, 'water': 1.00, 'grass': 0.80 },
            'grass': { 'fire': 0.80, 'water': 1.25, 'grass': 1.00 }
        };

        // ç­ã®è¨ˆç®—ã«ä½¿ç”¨ã™ã‚‹å›ºå®šä¿‚æ•°
        const SQUAD_SCALING_FACTOR = 80;

        // å±æ€§ã®æ—¥æœ¬èªè¡¨ç¤ºå
        const attributeNames = {
            'fire': 'ğŸ”¥ ç«',
            'water': 'ğŸ’§ æ°´',
            'grass': 'ğŸŒ¿ è‰'
        };
        
        // åˆæœŸé¸æŠå±æ€§ã‚’ä¿æŒã™ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€‚æœ€å¤§6çµ„ã‚’å®šç¾©ã€‚
        let selectedAttributes = {};
        for (let i = 1; i <= NUM_SLOTS; i++) {
            // åˆæœŸå€¤ã¨ã—ã¦é©å½“ãªå±æ€§ã‚’è¨­å®š
            selectedAttributes['my' + i] = (i % 3 === 1) ? 'grass' : (i % 3 === 2) ? 'fire' : 'water';
            selectedAttributes['enemy' + i] = (i % 3 === 1) ? 'grass' : (i % 3 === 2) ? 'fire' : 'water';
        }

        /**
         * æ¬¡ã®ä¸»åŠ›ã‚¹ãƒ­ãƒƒãƒˆã‚’è¡¨ç¤ºã™ã‚‹
         */
        function addSlot() {
            if (currentSlotCount < NUM_SLOTS) {
                currentSlotCount++;

                // æ¬¡ã®å‘³æ–¹ã‚¹ãƒ­ãƒƒãƒˆã‚’è¡¨ç¤º
                const mySlot = document.getElementById(`mySlot${currentSlotCount}`);
                if (mySlot) mySlot.classList.remove('hidden');

                // æ¬¡ã®æ•µã‚¹ãƒ­ãƒƒãƒˆã‚’è¡¨ç¤º
                const enemySlot = document.getElementById(`enemySlot${currentSlotCount}`);
                if (enemySlot) enemySlot.classList.remove('hidden');

                // ãƒœã‚¿ãƒ³ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’æ›´æ–°
                const button = document.getElementById('addSlotButton');
                button.textContent = `ä¸»åŠ›è¿½åŠ  (ç¾åœ¨ ${currentSlotCount} / ${NUM_SLOTS})`;
                
                // æœ€å¤§ã‚¹ãƒ­ãƒƒãƒˆã«é”ã—ãŸã‚‰ãƒœã‚¿ãƒ³ã‚’éè¡¨ç¤ºã«ã™ã‚‹
                if (currentSlotCount === NUM_SLOTS) {
                    button.classList.add('hidden');
                }
            }
        }


        // åˆæœŸé¸æŠçŠ¶æ…‹ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
        document.addEventListener('DOMContentLoaded', () => {
            // å…¨ã¦ã®ä¸»åŠ›ã«å¯¾ã—ã¦åˆæœŸå±æ€§ã‚’è¨­å®š
            for (let i = 1; i <= NUM_SLOTS; i++) {
                selectAttribute('my', i, selectedAttributes['my' + i], false);
                selectAttribute('enemy', i, selectedAttributes['enemy' + i], false);
            }
            
            // åˆå›ãƒ­ãƒ¼ãƒ‰æ™‚ã«ä¸€åº¦è¨ˆç®—ã‚’å®Ÿè¡Œ (å…¥åŠ›å€¤ãŒç©ºæ¬„ã®ãŸã‚ã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã§å…¥åŠ›å¾…ã¡è¡¨ç¤ºã«ãªã‚‹)
            calculateDebuff();
        });

        /**
         * å±æ€§ãƒœã‚¿ãƒ³ã®é¸æŠçŠ¶æ…‹ã‚’æ›´æ–°ã™ã‚‹
         */
        function selectAttribute(type, num, attribute, recalculate = true) {
            const container = document.getElementById(type + 'Attribute' + num);
            if (!container) return;

            // é¸æŠã•ã‚ŒãŸå±æ€§ã‚’ä¿å­˜
            selectedAttributes[type + num] = attribute;

            // å…¨ã¦ã®ãƒœã‚¿ãƒ³ã®çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
            container.querySelectorAll('.attribute-button').forEach(button => {
                button.classList.remove('selected', 'ring-4', 'ring-indigo-300', 'ring-red-300', button.dataset.bg);
                button.style.color = '#4b5563'; // gray-600
                button.style.borderColor = '#d1d5db'; // gray-300
            });

            // é¸æŠã•ã‚ŒãŸãƒœã‚¿ãƒ³ã«é¸æŠçŠ¶æ…‹ã‚’é©ç”¨
            const selectedButton = container.querySelector(`[data-attribute="${attribute}"]`);
            if (selectedButton) {
                selectedButton.classList.add('selected', 'ring-4');
                
                selectedButton.classList.add(selectedButton.dataset.bg);
                selectedButton.style.color = 'white'; 
                
                if (type === 'my') {
                    selectedButton.classList.add('ring-indigo-300');
                    selectedButton.style.borderColor = '#4f46e5'; 
                } else {
                    selectedButton.classList.add('ring-red-300');
                    selectedButton.style.borderColor = '#dc2626'; 
                }
            }

            if (recalculate) {
                calculateDebuff();
            }
        }


        /**
         * ãƒ‡ãƒãƒ•è¨ˆç®—ã‚’å®Ÿè¡Œã™ã‚‹ãƒ¡ã‚¤ãƒ³é–¢æ•°
         */
        function calculateDebuff() {
            const errorMessageDiv = document.getElementById('errorMessage');
            const outputDiv = document.getElementById('output');
            
            errorMessageDiv.classList.add('hidden');
            
            let totalEffectiveMyPower = 0;
            let totalEnemyPower = 0;
            let hasValidInput = false;
            let multiplierDetailsHtml = '';

            // 1. 1ã‹ã‚‰ç¾åœ¨ã®è¡¨ç¤ºã‚¹ãƒ­ãƒƒãƒˆã¾ã§ã®ä¸»åŠ›ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ«ãƒ¼ãƒ—ã§å‡¦ç†
            for (let i = 1; i <= NUM_SLOTS; i++) { // NUM_SLOTSã¾ã§ãƒ«ãƒ¼ãƒ—ã‚’å›ã™ãŒã€éè¡¨ç¤ºã‚¹ãƒ­ãƒƒãƒˆã®æˆ¦åŠ›ã¯0ã«ãªã‚‹
                const myPowerInput = document.getElementById('myPower' + i);
                const enemyPowerInput = document.getElementById('enemyPower' + i);
                
                // DOMãŒå­˜åœ¨ã—ãªã„ï¼ˆã‚ã‚Šãˆãªã„ãŒå®‰å…¨ã®ãŸã‚ï¼‰ã¾ãŸã¯å…¥åŠ›å€¤ã‚’å–å¾—
                const myPower = parseFloat(myPowerInput?.value) || 0;
                const enemyPower = parseFloat(enemyPowerInput?.value) || 0;

                // ä¸¡æ–¹ã®æˆ¦åŠ›ã«æœ‰åŠ¹ãªå…¥åŠ›ãŒã‚ã‚‹å ´åˆã®ã¿è¨ˆç®—ã«å«ã‚ã‚‹
                if (myPower > 0 && enemyPower > 0) {
                    hasValidInput = true;
                    
                    const myAttr = selectedAttributes['my' + i];
                    const enemyAttr = selectedAttributes['enemy' + i];

                    const multiplier = multipliers[myAttr]?.[enemyAttr] || 1.00;
                    const effectiveMyPower = myPower * multiplier;

                    totalEffectiveMyPower += effectiveMyPower;
                    totalEnemyPower += enemyPower;
                    
                    // å±æ€§è£œæ­£è©³ç´°ã®å‹•çš„ç”Ÿæˆ
                    multiplierDetailsHtml += `
                        <p class="text-xs sm:text-sm">
                            <span class="font-bold text-indigo-700">ä¸»åŠ›${i}</span> 
                            (${attributeNames[myAttr]} vs ${attributeNames[enemyAttr]}) :
                            <span class="font-bold text-base">${multiplier.toFixed(2)}</span>å€
                        </p>
                    `;
                }
            }

            // å¿…é ˆå…¥åŠ›é …ç›®ã®ãƒã‚§ãƒƒã‚¯ (æœ‰åŠ¹ãªå…¥åŠ›ãŒ1çµ„ã§ã‚‚ãªã‘ã‚Œã°ã‚¨ãƒ©ãƒ¼/å…¥åŠ›å¾…ã¡)
            if (!hasValidInput) {
                errorMessageDiv.textContent = 'å°‘ãªãã¨ã‚‚1çµ„ã®æˆ¦åŠ›ã«1ä»¥ä¸Šã®æ­£ã®æ•°ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚';
                errorMessageDiv.classList.remove('hidden');
                
                document.getElementById('neededSquads').textContent = 'å…¥åŠ›å¾…ã¡';
                document.getElementById('neededPeople').textContent = 'å…¥åŠ›å¾…ã¡';
                document.getElementById('effectiveTotalPower').textContent = '0';
                document.getElementById('enemyTotalPower').textContent = '0';
                document.getElementById('multiplierText').innerHTML = '<p class="text-sm text-gray-500">ä¸»åŠ›ã”ã¨ã®å±æ€§è£œæ­£ç‡ãŒã“ã“ã«å…¥ã‚Šã¾ã™ (å…¥åŠ›ãŒã‚ã£ãŸçµ„ã®ã¿)</p>';

                // çµæœã‚¨ãƒªã‚¢ã®è‰²ã‚’å…¥åŠ›å¾…ã¡ï¼ˆã‚°ãƒ¬ãƒ¼ï¼‰ã«
                outputDiv.classList.remove('bg-green-100', 'border-green-300', 'bg-blue-100', 'border-blue-300');
                outputDiv.classList.add('bg-gray-100', 'border-gray-300');
                
                return;
            }

            // ã‚¨ãƒ©ãƒ¼ãŒãªã„å ´åˆã€çµæœã‚¨ãƒªã‚¢ã®è‰²ã‚’ãƒªã‚»ãƒƒãƒˆ
            outputDiv.classList.remove('bg-gray-100', 'border-gray-300');


            // 3. åˆè¨ˆæˆ¦åŠ›ã¨å±æ€§è£œæ­£è©³ç´°ã®è¡¨ç¤º
            
            document.getElementById('effectiveTotalPower').textContent = totalEffectiveMyPower.toFixed(2);
            document.getElementById('enemyTotalPower').textContent = totalEnemyPower.toFixed(2);
            
            // å±æ€§è£œæ­£ãƒ†ã‚­ã‚¹ãƒˆã®æ›´æ–°
            document.getElementById('multiplierText').innerHTML = multiplierDetailsHtml;


            // 4. ä¸è¶³ç‡ã¨ç­æ•°ã®è¨ˆç®—
            
            // æ•µæˆ¦åŠ›ã«å¯¾ã™ã‚‹æœ‰åŠ¹æˆ¦åŠ›ã®ä¸è¶³ç‡ã‚’è¨ˆç®—
            const deficitRatio = 1 - (totalEffectiveMyPower / totalEnemyPower);

            let neededSquads = 0;
            let neededPeople = 0;
            
            // ä¸è¶³ç‡ãŒ0ã‚ˆã‚Šå¤§ãã„å ´åˆã€ç­ã®è¨ˆç®—ã‚’å®Ÿè¡Œ
            if (deficitRatio > 0) {
                // ä¸è¶³ç‡ã«å®šæ•°80ã‚’ä¹—ã˜ã‚‹
                const squadCalculationBase = deficitRatio * SQUAD_SCALING_FACTOR;
                
                // åˆ‡ã‚Šä¸Šã’
                const roundedSquads = Math.ceil(squadCalculationBase);
                
                neededSquads = Math.max(0, roundedSquads);
                
                // äººæ•°è¨ˆç®—
                neededPeople = neededSquads * 6;
            }

            // 5. æœ€çµ‚çµæœã®è¡¨ç¤º
            document.getElementById('neededSquads').textContent = `${neededSquads} ç­`;
            document.getElementById('neededPeople').textContent = `${neededPeople} äºº`;
            
            // å¿…è¦ãªç­æ•°ãŒ0ã®å ´åˆã®ç‰¹åˆ¥è¡¨ç¤º
            if (neededSquads === 0) {
                outputDiv.classList.remove('bg-green-100', 'border-green-300');
                outputDiv.classList.add('bg-blue-100', 'border-blue-300');
                document.getElementById('neededSquads').textContent = 'ä¸è¦ (æˆ¦åŠ›å„ªä½)';
                document.getElementById('neededPeople').textContent = 'ä¸è¦ (æˆ¦åŠ›å„ªä½)';
            } else {
                outputDiv.classList.remove('bg-blue-100', 'border-blue-300');
                outputDiv.classList.add('bg-green-100', 'border-green-300');
            }
        }
    </script>
</body>
</html>